<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dukan Pro - Business Suite</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <div id="license-input-container" class="d-flex">
        <div class="card license-card">
            <div class="card-body text-center">
                <h3 class="card-title mb-4"><i class="fas fa-shield-alt me-2"></i>‡§∏‡•â‡§´‡•ç‡§ü‡§µ‡•á‡§Ø‡§∞ ‡§è‡§ï‡•ç‡§ü‡§ø‡§µ‡•á‡§∂‡§®</h3>
                <p class="text-muted">‡§ú‡§æ‡§∞‡•Ä ‡§∞‡§ñ‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§Ö‡§™‡§®‡•Ä ‡§≤‡§æ‡§á‡§∏‡•á‡§Ç‡§∏ ‡§ï‡•Å‡§Ç‡§ú‡•Ä ‡§¶‡§∞‡•ç‡§ú ‡§ï‡§∞‡•á‡§Ç‡•§</p>
                <div class="input-group mb-3">
                    <span class="input-group-text">üîë</span>
                    <input type="text" class="form-control" id="license-key" placeholder="‡§Ü‡§™‡§ï‡•Ä ‡§≤‡§æ‡§á‡§∏‡•á‡§Ç‡§∏ ‡§ï‡•Å‡§Ç‡§ú‡•Ä">
                </div>
                <button id="validate-key-btn" class="btn btn-primary w-100">‡§ê‡§™ ‡§∏‡§ï‡•ç‡§∞‡§ø‡§Ø ‡§ï‡§∞‡•á‡§Ç</button>
                <div id="license-msg" class="mt-3 fw-bold"></div>
            </div>
        </div>
    </div>

    <div id="main-app" class="d-none">
        <nav id="sidebar" class="no-print">
            <div class="sidebar-header">
                <h3><i class="fas fa-rocket me-2"></i>Dukan Pro</h3>
            </div>
            <ul class="list-unstyled components" id="main-tabs" role="tablist">
                <li><button class="nav-link active" id="dashboard-tab-btn" data-bs-toggle="tab" data-bs-target="#dashboard-pane" type="button"><i class="fas fa-tachometer-alt me-2"></i> ‡§°‡•à‡§∂‡§¨‡•ã‡§∞‡•ç‡§°</button></li>
                <li><button class="nav-link" id="invoice-tab-btn" data-bs-toggle="tab" data-bs-target="#invoice-pane" type="button"><i class="fas fa-file-invoice me-2"></i> ‡§á‡§®‡§µ‡•â‡§á‡§∏ ‡§¨‡§®‡§æ‡§è‡§Ç</button></li>
                <li><button class="nav-link" id="stock-tab-btn" data-bs-toggle="tab" data-bs-target="#stock-pane" type="button"><i class="fas fa-boxes-stacked me-2"></i> ‡§∏‡•ç‡§ü‡•â‡§ï</button></li>
                <li><button class="nav-link" id="purchase-tab-btn" data-bs-toggle="tab" data-bs-target="#purchase-pane" type="button"><i class="fas fa-shopping-cart me-2"></i> ‡§ñ‡§∞‡•Ä‡§¶</button></li>
                <li><button class="nav-link" id="crm-tab-btn" data-bs-toggle="tab" data-bs-target="#crm-pane" type="button"><i class="fas fa-users me-2"></i> ‡§ó‡•ç‡§∞‡§æ‡§π‡§ï (CRM)</button></li>
                <li><button class="nav-link" id="expenses-tab-btn" data-bs-toggle="tab" data-bs-target="#expenses-pane" type="button"><i class="fas fa-wallet me-2"></i> ‡§ñ‡§∞‡•ç‡§ö‡•á</button></li>
                <li><button class="nav-link" id="reports-tab-btn" data-bs-toggle="tab" data-bs-target="#reports-pane" type="button"><i class="fas fa-chart-line me-2"></i> ‡§∞‡§ø‡§™‡•ã‡§∞‡•ç‡§ü‡•ç‡§∏</button></li>
            </ul>
        </nav>

        <main id="main-content">
            <header class="header-bar no-print">
                <div class="d-flex justify-content-between align-items-center w-100">
                    <h1 class="mb-0 h4 text-white" id="header-title">üìä ‡§°‡•à‡§∂‡§¨‡•ã‡§∞‡•ç‡§°</h1>
                    <div id="welcome-user" class="text-white fw-bold"></div>
                </div>
            </header>

            <div id="expiry-notification-bar" class="alert mb-0 text-center fw-bold no-print" style="display: none; border-radius: 0;"></div>

            <div class="container-fluid mt-4">
                <div class="tab-content" id="myTabContent">
                    <div class="tab-pane fade show active" id="dashboard-pane" role="tabpanel">
                        <div class="row g-4">
                            <div class="col-md-3"><div class="card p-3 text-center stat-card bg-success text-white"><h5>‡§ï‡•Å‡§≤ ‡§¨‡§ø‡§ï‡•ç‡§∞‡•Ä</h5><h3 id="dash-total-sales">‚Çπ0</h3></div></div>
                            <div class="col-md-3"><div class="card p-3 text-center stat-card bg-warning text-dark"><h5>‡§ï‡•Å‡§≤ ‡§ñ‡§∞‡•Ä‡§¶</h5><h3 id="dash-total-purchases">‚Çπ0</h3></div></div>
                            <div class="col-md-3"><div class="card p-3 text-center stat-card bg-danger text-white"><h5>‡§ï‡•Å‡§≤ ‡§ñ‡§∞‡•ç‡§ö‡•á</h5><h3 id="dash-total-expenses">‚Çπ0</h3></div></div>
                            <div class="col-md-3"><div class="card p-3 text-center stat-card bg-info text-white"><h5>‡§∂‡•Å‡§¶‡•ç‡§ß ‡§≤‡§æ‡§≠</h5><h3 id="dash-net-profit">‚Çπ0</h3></div></div>
                        </div>
                    </div>

                    <div class="tab-pane fade" id="invoice-pane" role="tabpanel">
                        <div class="row g-4">
                            <div class="col-lg-5 no-print">
                                <div class="card p-4">
                                    <h5><i class="fas fa-store me-2"></i>‡§¨‡§ø‡§≤‡§ø‡§Ç‡§ó ‡§µ‡§ø‡§µ‡§∞‡§£</h5>
                                    <div class="row g-3 mt-2">
                                        <div class="col-md-6"><label class="form-label">Shop Name</label><input type="text" class="form-control" id="shopName" value="Digital Store"></div>
                                        <div class="col-md-6"><label class="form-label">GSTIN</label><input type="text" class="form-control" id="shopGstin" placeholder="24ABCDE1234F1Z5"></div>
                                        <div class="col-12"><label class="form-label">Address</label><input type="text" class="form-control" id="shopAddress" value="Station Road, Jaipur"></div>
                                        <div class="col-md-6"><label class="form-label">Shop Logo</label><input type="file" id="shopLogo" class="form-control" accept="image/*"></div>
                                        <div class="col-md-6"><label class="form-label">Payment QR</label><input type="file" id="qrCode" class="form-control" accept="image/*"></div>
                                        <hr>
                                        <div class="col-md-6"><label class="form-label">Invoice No.</label><input type="text" class="form-control" id="invoice-number" value="INV-0001"></div>
                                        <div class="col-md-6"><label class="form-label">Customer Name</label><input type="text" class="form-control" id="customer-name" list="customer-list" placeholder="Search Customer"> <datalist id="customer-list"></datalist></div>
                                    </div>
                                    <hr class="my-4">
                                    <h5><i class="fas fa-shopping-cart me-2"></i>‡§Ü‡§á‡§ü‡§Æ ‡§ú‡•ã‡§°‡§º‡•á‡§Ç</h5>
                                    <div id="items-container" class="mt-2"></div>
                                    <button class="btn btn-outline-primary btn-sm mt-3" onclick="addItemRow()"><i class="fas fa-plus me-2"></i>‡§®‡§Ø‡§æ ‡§Ü‡§á‡§ü‡§Æ ‡§ú‡•ã‡§°‡§º‡•á‡§Ç</button>
                                    <div class="col-12 mt-4">
                                        <label class="form-label">Notes / Terms</label>
                                        <textarea id="notes" class="form-control" rows="2">‡§¨‡§ø‡§ï‡•ç‡§∞‡•Ä ‡§ï‡§æ ‡§∏‡§æ‡§Æ‡§æ‡§® ‡§µ‡§æ‡§™‡§∏ ‡§®‡§π‡•Ä‡§Ç ‡§≤‡§ø‡§Ø‡§æ ‡§ú‡§æ‡§è‡§ó‡§æ‡•§</textarea>
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-7">
                                <div class="sticky-top py-2">
                                    <div class="d-flex flex-wrap gap-2 mb-3 no-print">
                                        <button class="btn btn-success" onclick="logAndClearInvoice()"><i class="fas fa-save me-1"></i>Save & New</button>
                                        <button class="btn btn-secondary" onclick="printInvoice()"><i class="fas fa-print me-2"></i>Print</button>
                                        <button class="btn btn-info text-white" onclick="downloadInvoice()"><i class="fas fa-download me-2"></i>Download PDF</button>
                                        <button class="btn btn-danger" onclick="clearBill()"><i class="fas fa-eraser me-1"></i>Clear Bill</button>
                                    </div>
                                    <div id="invoice-preview-container"><div id="invoice-preview" class="card card-body"></div></div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="tab-pane fade" id="stock-pane" role="tabpanel">
                        <div class="card">
                            <div class="card-header d-flex justify-content-between align-items-center">
                                <h5>‡§Æ‡•å‡§ú‡•Ç‡§¶‡§æ ‡§∏‡•ç‡§ü‡•â‡§ï</h5>
                                <div class="d-flex gap-2">
                                    <input type="text" id="search-item-stock" class="form-control" placeholder="Search SKU or Name...">
                                    <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#addStockModal">‡§®‡§Ø‡§æ ‡§Ü‡§á‡§ü‡§Æ</button>
                                    <button id="export-stock-btn" class="btn btn-success">Export CSV</button>
                                </div>
                            </div>
                            <div class="card-body">
                                <div class="table-responsive">
                                    <table class="table table-striped table-hover">
                                        <thead>
                                            <tr><th>SKU</th><th>‡§Ü‡§á‡§ü‡§Æ</th><th>‡§ñ‡§∞‡•Ä‡§¶ ‡§Æ‡•Ç‡§≤‡•ç‡§Ø</th><th>‡§¨‡§ø‡§ï‡•ç‡§∞‡•Ä ‡§Æ‡•Ç‡§≤‡•ç‡§Ø</th><th>‡§Æ‡§æ‡§§‡•ç‡§∞‡§æ</th><th>Last Updated</th></tr>
                                        </thead>
                                        <tbody id="stock-table-body"></tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="tab-pane fade" id="purchase-pane" role="tabpanel">...Purchase Pane...</div>
                    <div class="tab-pane fade" id="crm-pane" role="tabpanel">...CRM Pane...</div>
                    <div class="tab-pane fade" id="expenses-pane" role="tabpanel">
                        <div class="card">
                            <div class="card-header d-flex justify-content-between align-items-center">
                                <h5>‡§ñ‡§∞‡•ç‡§ö‡•ã‡§Ç ‡§ï‡§æ ‡§∞‡§ø‡§ï‡•â‡§∞‡•ç‡§°</h5>
                                <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#addExpenseModal">‡§®‡§Ø‡§æ ‡§ñ‡§∞‡•ç‡§ö‡§æ ‡§ú‡•ã‡§°‡§º‡•á‡§Ç</button>
                            </div>
                            <div class="card-body">
                                <table class="table table-striped">
                                    <thead><tr><th>Date</th><th>Category</th><th>Amount</th><th>Description</th></tr></thead>
                                    <tbody id="expense-table-body"></tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                    <div class="tab-pane fade" id="reports-pane" role="tabpanel">...Reports Pane...</div>
                </div>
            </div>
        </main>
    </div>

    <template id="invoice-template">
        <div class="invoice-container">
            <div class="invoice-header">
                <div class="shop-details">
                    <img id="logo-preview" src="" alt="Logo" class="logo-placeholder" style="max-height: 50px; display: none;">
                    <h3 id="inv-shop-name" class="shop-name">Digital Store</h3>
                    <p id="inv-shop-address">Station Road, Jaipur</p>
                    <p id="inv-shop-contact">Phone: +91-XXXXXXXXXX</p>
                    <p id="inv-shop-gstin">GSTIN: <span class="gstin-val"></span></p>
                </div>
                <div class="invoice-meta text-end">
                    <h2>‡§ü‡•à‡§ï‡•ç‡§∏ ‡§á‡§®‡§µ‡•â‡§á‡§∏</h2>
                    <p class="mb-0"><strong>‡§á‡§®‡§µ‡•â‡§á‡§∏ ‡§®‡§Ç:</strong> <span id="inv-number">INV-0001</span></p>
                    <p class="mb-0"><strong>‡§¶‡§ø‡§®‡§æ‡§Ç‡§ï:</strong> <span id="inv-date"></span></p>
                </div>
            </div>
            <div class="customer-details">
                <h6 class="text-primary">‡§¨‡§ø‡§≤ ‡§ü‡•Ç (Bill To)</h6>
                <p class="mb-0"><strong>‡§®‡§æ‡§Æ:</strong> <span id="inv-customer-name">Guest Customer</span></p>
                <p class="mb-0"><strong>‡§™‡§§‡§æ:</strong> <span id="inv-customer-address"></span></p>
                <p class="mb-0"><strong>‡§´‡•ã‡§®:</strong> <span id="inv-customer-contact"></span></p>
            </div>
            <table class="invoice-table mt-4">
                <thead><tr><th>#</th><th>‡§Ü‡§á‡§ü‡§Æ ‡§µ‡§ø‡§µ‡§∞‡§£</th><th>HSN/SKU</th><th>‡§Æ‡§æ‡§§‡•ç‡§∞‡§æ</th><th>‡§Æ‡•Ç‡§≤‡•ç‡§Ø</th><th>GST (%)</th><th>‡§ï‡•Å‡§≤ ‡§∞‡§æ‡§∂‡§ø</th></tr></thead>
                <tbody id="inv-item-list"></tbody>
            </table>
            <div class="invoice-summary row">
                <div class="col-7">
                    <div class="summary-box"><p>‡§ï‡•Å‡§≤ ‡§∂‡§¨‡•ç‡§¶‡•ã‡§Ç ‡§Æ‡•á‡§Ç: <strong id="amount-in-words"></strong></p></div>
                    <div class="notes-box mt-3">
                        <h6>‡§®‡§ø‡§Ø‡§Æ ‡§è‡§µ‡§Ç ‡§∂‡§∞‡•ç‡§§‡•á‡§Ç (Notes)</h6>
                        <p id="inv-notes">‡§¨‡§ø‡§ï‡•ç‡§∞‡•Ä ‡§ï‡§æ ‡§∏‡§æ‡§Æ‡§æ‡§® ‡§µ‡§æ‡§™‡§∏ ‡§®‡§π‡•Ä‡§Ç ‡§≤‡§ø‡§Ø‡§æ ‡§ú‡§æ‡§è‡§ó‡§æ‡•§</p>
                    </div>
                </div>
                <div class="col-5">
                    <table class="table table-sm text-end summary-table">
                        <tbody>
                            <tr><td>‡§â‡§™-‡§ï‡•Å‡§≤ (Subtotal):</td><td><span id="inv-sub-total">‚Çπ0.00</span></td></tr>
                            <tr><td>‡§ï‡•Å‡§≤ GST:</td><td><span id="inv-total-gst">‚Çπ0.00</span></td></tr>
                            <tr class="table-primary fw-bold"><td>‡§ï‡•Å‡§≤ ‡§¶‡•á‡§Ø ‡§∞‡§æ‡§∂‡§ø (Grand Total):</td><td><span id="inv-grand-total">‚Çπ0.00</span></td></tr>
                        </tbody>
                    </table>
                </div>
            </div>
            <div class="invoice-footer">
                <div class="qr-box">
                    <p class="fw-bold mb-1">UPI ‡§≠‡•Å‡§ó‡§§‡§æ‡§® ‡§ï‡•á ‡§≤‡§ø‡§è ‡§∏‡•ç‡§ï‡•à‡§® ‡§ï‡§∞‡•á‡§Ç:</p>
                    <img id="qr-preview" src="" alt="QR Code" class="qr-placeholder" style="max-width: 120px; display: none;">
                </div>
                <div class="signature">
                    <p class="fw-bold mb-0">‡§Ö‡§ß‡§ø‡§ï‡•É‡§§ ‡§π‡§∏‡•ç‡§§‡§æ‡§ï‡•ç‡§∑‡§∞‡§ï‡§∞‡•ç‡§§‡§æ</p>
                    <p>(<span id="inv-shop-signature">Digital Store</span> ‡§ï‡•á ‡§≤‡§ø‡§è)</p>
                </div>
            </div>
        </div>
    </template>
    
    <div class="modal fade" id="addStockModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Add/Update Stock</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="add-stock-form">
                        <div class="mb-3"><label class="form-label">SKU</label><input type="text" id="stock-sku" class="form-control" required></div>
                        <div class="mb-3"><label class="form-label">Item Name</label><input type="text" id="stock-item-name" class="form-control" required></div>
                        <div class="mb-3"><label class="form-label">Purchase Price</label><input type="number" id="stock-purchase-price" class="form-control" required></div>
                        <div class="mb-3"><label class="form-label">Sale Price</label><input type="number" id="stock-sale-price" class="form-control" required></div>
                        <div class="mb-3"><label class="form-label">Quantity to Add</label><input type="number" id="stock-quantity" class="form-control" required></div>
                        <button type="submit" class="btn btn-primary w-100">Save Stock</button>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="addExpenseModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header"><h5 class="modal-title">Add Expense</h5><button type="button" class="btn-close" data-bs-dismiss="modal"></button></div>
                <div class="modal-body">
                    <form id="add-expense-form">
                        <div class="mb-3"><label class="form-label">Category</label><input type="text" id="expense-category" class="form-control" required></div>
                        <div class="mb-3"><label class="form-label">Amount</label><input type="number" id="expense-amount" class="form-control" required></div>
                        <div class="mb-3"><label class="form-label">Description</label><textarea id="expense-description" class="form-control"></textarea></div>
                        <button type="submit" class="btn btn-primary w-100">Add Expense</button>
                    </form>
                </div>
            </div>
        </div>
    </div>
    
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="script.js"></script>
</body>
</html>
