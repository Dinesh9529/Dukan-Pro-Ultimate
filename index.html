<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dukan Pro - Business Suite</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <div id="license-input-container" class="d-flex">
        <div class="card license-card">
            <div class="card-body text-center">
                <h3 class="card-title mb-4"><i class="fas fa-shield-alt me-2"></i>‡§∏‡•â‡§´‡•ç‡§ü‡§µ‡•á‡§Ø‡§∞ ‡§è‡§ï‡•ç‡§ü‡§ø‡§µ‡•á‡§∂‡§®</h3>
                <p class="text-muted">‡§ú‡§æ‡§∞‡•Ä ‡§∞‡§ñ‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§Ö‡§™‡§®‡•Ä ‡§≤‡§æ‡§á‡§∏‡•á‡§Ç‡§∏ ‡§ï‡•Å‡§Ç‡§ú‡•Ä ‡§¶‡§∞‡•ç‡§ú ‡§ï‡§∞‡•á‡§Ç‡•§</p>
                <div class="input-group mb-3">
                    <span class="input-group-text">üîë</span>
                    <input type="text" class="form-control" id="license-key" placeholder="‡§Ü‡§™‡§ï‡•Ä ‡§≤‡§æ‡§á‡§∏‡•á‡§Ç‡§∏ ‡§ï‡•Å‡§Ç‡§ú‡•Ä">
                </div>
                <button id="validate-key-btn" class="btn btn-primary w-100">‡§ê‡§™ ‡§∏‡§ï‡•ç‡§∞‡§ø‡§Ø ‡§ï‡§∞‡•á‡§Ç</button>
                <div id="license-msg" class="mt-3 fw-bold"></div>
            </div>
        </div>
    </div>

    <div id="main-app" class="d-none">
        <nav id="sidebar" class="no-print">
            <div class="sidebar-header">
                <h3><i class="fas fa-rocket me-2"></i>Dukan Pro</h3>
            </div>
            <ul class="list-unstyled components" id="main-tabs" role="tablist">
                <li><button class="nav-link active" data-bs-toggle="tab" data-bs-target="#dashboard-pane" type="button" data-title="üìä ‡§°‡•à‡§∂‡§¨‡•ã‡§∞‡•ç‡§°"><i class="fas fa-tachometer-alt me-2"></i> ‡§°‡•à‡§∂‡§¨‡•ã‡§∞‡•ç‡§°</button></li>
                <li><button class="nav-link" data-bs-toggle="tab" data-bs-target="#invoice-pane" type="button" data-title="üßæ ‡§á‡§®‡§µ‡•â‡§á‡§∏ ‡§¨‡§®‡§æ‡§è‡§Ç"><i class="fas fa-file-invoice me-2"></i> ‡§á‡§®‡§µ‡•â‡§á‡§∏ ‡§¨‡§®‡§æ‡§è‡§Ç</button></li>
                <li><button class="nav-link" data-bs-toggle="tab" data-bs-target="#stock-pane" type="button" data-title="üì¶ ‡§∏‡•ç‡§ü‡•â‡§ï"><i class="fas fa-boxes-stacked me-2"></i> ‡§∏‡•ç‡§ü‡•â‡§ï</button></li>
                <li><button class="nav-link" data-bs-toggle="tab" data-bs-target="#purchase-pane" type="button" data-title="üõí ‡§ñ‡§∞‡•Ä‡§¶"><i class="fas fa-shopping-cart me-2"></i> ‡§ñ‡§∞‡•Ä‡§¶</button></li>
                <li><button class="nav-link" data-bs-toggle="tab" data-bs-target="#crm-pane" type="button" data-title="üë• ‡§ó‡•ç‡§∞‡§æ‡§π‡§ï (CRM)"><i class="fas fa-users me-2"></i> ‡§ó‡•ç‡§∞‡§æ‡§π‡§ï (CRM)</button></li>
                <li><button class="nav-link" data-bs-toggle="tab" data-bs-target="#expenses-pane" type="button" data-title="üí≥ ‡§ñ‡§∞‡•ç‡§ö‡•á"><i class="fas fa-wallet me-2"></i> ‡§ñ‡§∞‡•ç‡§ö‡•á</button></li>
                <li><button class="nav-link" data-bs-toggle="tab" data-bs-target="#reports-pane" type="button" data-title="üìà ‡§∞‡§ø‡§™‡•ã‡§∞‡•ç‡§ü‡•ç‡§∏"><i class="fas fa-chart-line me-2"></i> ‡§∞‡§ø‡§™‡•ã‡§∞‡•ç‡§ü‡•ç‡§∏</button></li>
            </ul>
        </nav>

        <main id="main-content">
            <header class="header-bar no-print">
                <div class="d-flex justify-content-between align-items-center w-100">
                    <h1 class="mb-0 h4 text-white" id="header-title">üìä ‡§°‡•à‡§∂‡§¨‡•ã‡§∞‡•ç‡§°</h1>
                    <div id="welcome-user" class="text-white fw-bold"></div>
                </div>
            </header>
            <div id="expiry-notification-bar" class="alert mb-0 text-center fw-bold no-print" style="display: none; border-radius: 0;"></div>
            
            <div class="container-fluid mt-4">
                <div class="tab-content" id="myTabContent">
                    
                    <div class="tab-pane fade show active" id="dashboard-pane" role="tabpanel">
                         <div class="row g-4">
                            <div class="col-md-3"><div class="card p-3 text-center stat-card bg-success text-white"><h5>‡§ï‡•Å‡§≤ ‡§¨‡§ø‡§ï‡•ç‡§∞‡•Ä</h5><h3 id="dash-total-sales">‚Çπ0</h3></div></div>
                            <div class="col-md-3"><div class="card p-3 text-center stat-card bg-warning text-dark"><h5>‡§ï‡•Å‡§≤ ‡§ñ‡§∞‡•Ä‡§¶</h5><h3 id="dash-total-purchases">‚Çπ0</h3></div></div>
                            <div class="col-md-3"><div class="card p-3 text-center stat-card bg-danger text-white"><h5>‡§ï‡•Å‡§≤ ‡§ñ‡§∞‡•ç‡§ö‡•á</h5><h3 id="dash-total-expenses">‚Çπ0</h3></div></div>
                            <div class="col-md-3"><div class="card p-3 text-center stat-card bg-info text-white"><h5>‡§∂‡•Å‡§¶‡•ç‡§ß ‡§≤‡§æ‡§≠</h5><h3 id="dash-net-profit">‚Çπ0</h3></div></div>
                        </div>
                    </div>

                    <div class="tab-pane fade" id="invoice-pane" role="tabpanel">
                        <div class="row g-4">
                            <div class="col-lg-5 no-print">
                                <div class="card p-4">
                                    <h5><i class="fas fa-store me-2"></i>‡§¨‡§ø‡§≤‡§ø‡§Ç‡§ó ‡§µ‡§ø‡§µ‡§∞‡§£</h5>
                                    <div class="row g-3 mt-2">
                                        <div class="col-md-6"><label class="form-label">Shop Name</label><input type="text" class="form-control" id="shopName" value="Digital Store"></div>
                                        <div class="col-md-6"><label class="form-label">GSTIN</label><input type="text" class="form-control" id="shopGstin" placeholder="Optional"></div>
                                        <div class="col-12"><label class="form-label">Address</label><input type="text" class="form-control" id="shopAddress" value="Jaipur, Rajasthan"></div>
                                        <hr>
                                        <div class="col-md-6"><label class="form-label">Invoice No.</label><input type="text" class="form-control" id="invoice-number" value="INV-0001"></div>
                                        <div class="col-md-6"><label class="form-label">Customer</label><input type="text" class="form-control" id="customer-name" list="customer-list" placeholder="Search or Add Customer"><datalist id="customer-list"></datalist></div>
                                    </div>
                                    <hr class="my-4">
                                    <h5><i class="fas fa-shopping-cart me-2"></i>‡§Ü‡§á‡§ü‡§Æ ‡§ú‡•ã‡§°‡§º‡•á‡§Ç</h5>
                                    <div id="items-container" class="mt-2"></div>
                                    <button class="btn btn-outline-primary btn-sm mt-3" onclick="addItemRow()"><i class="fas fa-plus me-2"></i>‡§®‡§Ø‡§æ ‡§Ü‡§á‡§ü‡§Æ ‡§ú‡•ã‡§°‡§º‡•á‡§Ç</button>
                                    <hr class="my-4">
                                    <h5><i class="fa-solid fa-money-bill-wave me-2"></i>‡§≠‡•Å‡§ó‡§§‡§æ‡§® (Payment)</h5>
                                     <div class="row g-3">
                                        <div class="col-md-4"><label>‡§ï‡•Å‡§≤ ‡§≠‡•Å‡§ó‡§§‡§æ‡§®</label><input type="number" id="amount-paid" class="form-control" value="0"></div>
                                        <div class="col-md-4"><label>‡§¨‡§ï‡§æ‡§Ø‡§æ ‡§∞‡§æ‡§∂‡§ø</label><h4 id="balance-due" class="mt-2 text-danger">‚Çπ0.00</h4></div>
                                        <div class="col-md-4"><label>Grand Total</label><h4 id="final-total" class="mt-2 text-success">‚Çπ0.00</h4></div>
                                     </div>
                                </div>
                            </div>
                            <div class="col-lg-7">
                                <div class="sticky-top py-2">
                                    <div class="d-flex flex-wrap gap-2 mb-3 no-print">
                                        <button class="btn btn-success" onclick="logAndClearInvoice()"><i class="fas fa-save me-1"></i>Save & New</button>
                                        <button class="btn btn-secondary" onclick="printInvoice()"><i class="fas fa-print me-2"></i>Print</button>
                                        <button class="btn btn-info text-white" id="download-pdf-btn" onclick="downloadInvoice()"><i class="fas fa-download me-2"></i>Download PDF</button>
                                        <button class="btn btn-danger" onclick="clearBill()"><i class="fas fa-eraser me-1"></i>Clear Bill</button>
                                    </div>
                                    <div id="invoice-preview-container"><div id="invoice-preview" class="card card-body"></div></div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="tab-pane fade" id="stock-pane" role="tabpanel">
                         <div class="card">
                            <div class="card-header d-flex justify-content-between align-items-center">
                                <h5>‡§Æ‡•å‡§ú‡•Ç‡§¶‡§æ ‡§∏‡•ç‡§ü‡•â‡§ï</h5>
                                <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#addStockModal"><i class="fas fa-plus me-1"></i>‡§®‡§Ø‡§æ ‡§Ü‡§á‡§ü‡§Æ ‡§ú‡•ã‡§°‡§º‡•á‡§Ç</button>
                            </div>
                            <div class="card-body">
                                <div class="table-responsive">
                                    <table class="table table-striped table-hover">
                                        <thead><tr><th>SKU</th><th>‡§Ü‡§á‡§ü‡§Æ</th><th>‡§ñ‡§∞‡•Ä‡§¶ ‡§Æ‡•Ç‡§≤‡•ç‡§Ø</th><th>‡§¨‡§ø‡§ï‡•ç‡§∞‡•Ä ‡§Æ‡•Ç‡§≤‡•ç‡§Ø</th><th>‡§Æ‡§æ‡§§‡•ç‡§∞‡§æ</th><th>‡§™‡§ø‡§õ‡§≤‡§æ ‡§Ö‡§™‡§°‡•á‡§ü</th></tr></thead>
                                        <tbody id="stock-table-body"></tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="tab-pane fade" id="purchase-pane" role="tabpanel">
                        <div class="card">
                            <div class="card-header"><h5>‡§®‡§à ‡§ñ‡§∞‡•Ä‡§¶ ‡§ï‡•Ä ‡§è‡§Ç‡§ü‡•ç‡§∞‡•Ä ‡§ï‡§∞‡•á‡§Ç</h5></div>
                            <div class="card-body">
                                <form id="purchase-form">
                                    <div class="row g-3">
                                        <div class="col-md-6"><label class="form-label">‡§Ü‡§á‡§ü‡§Æ ‡§ï‡§æ ‡§®‡§æ‡§Æ</label><input type="text" id="purchase-item-name" class="form-control" required list="stock-item-list"><datalist id="stock-item-list"></datalist></div>
                                        <div class="col-md-6"><label class="form-label">SKU (‡§Ø‡§¶‡§ø ‡§®‡§Ø‡§æ ‡§π‡•à)</label><input type="text" id="purchase-item-sku" class="form-control"></div>
                                        <div class="col-md-4"><label class="form-label">‡§Æ‡§æ‡§§‡•ç‡§∞‡§æ</label><input type="number" id="purchase-quantity" class="form-control" required min="1"></div>
                                        <div class="col-md-4"><label class="form-label">‡§™‡•ç‡§∞‡§§‡§ø ‡§Ü‡§á‡§ü‡§Æ ‡§ñ‡§∞‡•Ä‡§¶ ‡§Æ‡•Ç‡§≤‡•ç‡§Ø</label><input type="number" id="purchase-price" class="form-control" required min="0"></div>
                                        <div class="col-md-4"><label class="form-label">‡§∏‡§™‡•ç‡§≤‡§æ‡§Ø‡§∞</label><input type="text" id="purchase-supplier" class="form-control"></div>
                                        <div class="col-12 mt-4"><button type="submit" class="btn btn-success w-100">‡§ñ‡§∞‡•Ä‡§¶ ‡§ú‡•ã‡§°‡§º‡•á‡§Ç</button></div>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>

                    <div class="tab-pane fade" id="crm-pane" role="tabpanel">
                        <div class="card">
                            <div class="card-header d-flex justify-content-between align-items-center">
                                <h5>‡§ó‡•ç‡§∞‡§æ‡§π‡§ï ‡§∏‡•Ç‡§ö‡•Ä</h5>
                                <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#addCustomerModal"><i class="fas fa-user-plus me-1"></i>‡§®‡§Ø‡§æ ‡§ó‡•ç‡§∞‡§æ‡§π‡§ï ‡§ú‡•ã‡§°‡§º‡•á‡§Ç</button>
                            </div>
                            <div class="card-body">
                                <div class="table-responsive">
                                    <table class="table table-striped">
                                        <thead><tr><th>ID</th><th>‡§®‡§æ‡§Æ</th><th>‡§´‡•ã‡§®</th><th>‡§™‡§§‡§æ</th></tr></thead>
                                        <tbody id="customer-table-body"></tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="tab-pane fade" id="expenses-pane" role="tabpanel">
                        <div class="card">
                            <div class="card-header d-flex justify-content-between align-items-center">
                                <h5>‡§ñ‡§∞‡•ç‡§ö‡•ã‡§Ç ‡§ï‡§æ ‡§∞‡§ø‡§ï‡•â‡§∞‡•ç‡§°</h5>
                                <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#addExpenseModal"><i class="fas fa-plus me-1"></i>‡§®‡§Ø‡§æ ‡§ñ‡§∞‡•ç‡§ö‡§æ ‡§ú‡•ã‡§°‡§º‡•á‡§Ç</button>
                            </div>
                            <div class="card-body">
                                <div class="table-responsive">
                                    <table class="table table-striped">
                                        <thead><tr><th>‡§§‡§æ‡§∞‡•Ä‡§ñ</th><th>‡§ï‡•à‡§ü‡•á‡§ó‡§∞‡•Ä</th><th>‡§∞‡§æ‡§∂‡§ø</th><th>‡§µ‡§ø‡§µ‡§∞‡§£</th></tr></thead>
                                        <tbody id="expense-table-body"></tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="tab-pane fade" id="reports-pane" role="tabpanel">
                         <div class="card">
                            <div class="card-header"><h5>‡§∞‡§ø‡§™‡•ã‡§∞‡•ç‡§ü‡•ç‡§∏</h5></div>
                            <div class="card-body">
                                <div class="row g-3 align-items-end">
                                    <div class="col-md-3"><label>‡§∞‡§ø‡§™‡•ã‡§∞‡•ç‡§ü ‡§™‡•ç‡§∞‡§ï‡§æ‡§∞</label><select id="report-type" class="form-select"><option value="sales">‡§∏‡•á‡§≤‡•ç‡§∏ ‡§∞‡§ø‡§™‡•ã‡§∞‡•ç‡§ü</option><option value="expenses">‡§ñ‡§∞‡•ç‡§ö ‡§∞‡§ø‡§™‡•ã‡§∞‡•ç‡§ü</option></select></div>
                                    <div class="col-md-3"><label>‡§∏‡•á</label><input type="date" id="report-from-date" class="form-control"></div>
                                    <div class="col-md-3"><label>‡§§‡§ï</label><input type="date" id="report-to-date" class="form-control"></div>
                                    <div class="col-md-3"><button id="generate-report-btn" class="btn btn-primary w-100">‡§∞‡§ø‡§™‡•ã‡§∞‡•ç‡§ü ‡§¨‡§®‡§æ‡§è‡§Ç</button></div>
                                </div>
                                <hr>
                                <h5 id="report-title" class="mt-4">‡§∞‡§ø‡§™‡•ã‡§∞‡•ç‡§ü ‡§™‡§∞‡§ø‡§£‡§æ‡§Æ</h5>
                                <div id="report-output" class="table-responsive"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>
    
    <div class="modal fade" id="addStockModal" tabindex="-1">
        <div class="modal-dialog"><div class="modal-content">
            <div class="modal-header"><h5 class="modal-title">‡§∏‡•ç‡§ü‡•â‡§ï ‡§ú‡•ã‡§°‡§º‡•á‡§Ç/‡§Ö‡§™‡§°‡•á‡§ü ‡§ï‡§∞‡•á‡§Ç</h5><button type="button" class="btn-close" data-bs-dismiss="modal"></button></div>
            <div class="modal-body">
                <form id="add-stock-form">
                    <div class="mb-3"><label>SKU</label><input type="text" id="stock-sku" class="form-control" required></div>
                    <div class="mb-3"><label>‡§Ü‡§á‡§ü‡§Æ ‡§ï‡§æ ‡§®‡§æ‡§Æ</label><input type="text" id="stock-item-name" class="form-control" required></div>
                    <div class="mb-3"><label>‡§ñ‡§∞‡•Ä‡§¶ ‡§Æ‡•Ç‡§≤‡•ç‡§Ø</label><input type="number" id="stock-purchase-price" class="form-control" required></div>
                    <div class="mb-3"><label>‡§¨‡§ø‡§ï‡•ç‡§∞‡•Ä ‡§Æ‡•Ç‡§≤‡•ç‡§Ø</label><input type="number" id="stock-sale-price" class="form-control" required></div>
                    <div class="mb-3"><label>‡§Æ‡§æ‡§§‡•ç‡§∞‡§æ</label><input type="number" id="stock-quantity" class="form-control" required></div>
                    <button type="submit" class="btn btn-primary w-100">‡§∏‡•ç‡§ü‡•â‡§ï ‡§∏‡•á‡§µ ‡§ï‡§∞‡•á‡§Ç</button>
                </form>
            </div>
        </div></div>
    </div>
    <div class="modal fade" id="addExpenseModal" tabindex="-1">
         <div class="modal-dialog"><div class="modal-content">
            <div class="modal-header"><h5 class="modal-title">‡§®‡§Ø‡§æ ‡§ñ‡§∞‡•ç‡§ö‡§æ ‡§ú‡•ã‡§°‡§º‡•á‡§Ç</h5><button type="button" class="btn-close" data-bs-dismiss="modal"></button></div>
            <div class="modal-body">
                <form id="add-expense-form">
                    <div class="mb-3"><label>‡§ï‡•à‡§ü‡•á‡§ó‡§∞‡•Ä</label><input type="text" id="expense-category" class="form-control" required></div>
                    <div class="mb-3"><label>‡§∞‡§æ‡§∂‡§ø</label><input type="number" id="expense-amount" class="form-control" required></div>
                    <div class="mb-3"><label>‡§µ‡§ø‡§µ‡§∞‡§£</label><textarea id="expense-description" class="form-control"></textarea></div>
                    <button type="submit" class="btn btn-primary w-100">‡§ñ‡§∞‡•ç‡§ö‡§æ ‡§ú‡•ã‡§°‡§º‡•á‡§Ç</button>
                </form>
            </div>
        </div></div>
    </div>
     <div class="modal fade" id="addCustomerModal" tabindex="-1">
        <div class="modal-dialog"><div class="modal-content">
            <div class="modal-header"><h5 class="modal-title">‡§®‡§Ø‡§æ ‡§ó‡•ç‡§∞‡§æ‡§π‡§ï ‡§ú‡•ã‡§°‡§º‡•á‡§Ç</h5><button type="button" class="btn-close" data-bs-dismiss="modal"></button></div>
            <div class="modal-body">
                <form id="add-customer-form">
                    <div class="mb-3"><label>‡§®‡§æ‡§Æ</label><input type="text" id="customer-form-name" class="form-control" required></div>
                    <div class="mb-3"><label>‡§´‡•ã‡§®</label><input type="text" id="customer-form-contact" class="form-control"></div>
                    <div class="mb-3"><label>‡§™‡§§‡§æ</label><textarea id="customer-form-address" class="form-control"></textarea></div>
                    <button type="submit" class="btn btn-primary w-100">‡§ó‡•ç‡§∞‡§æ‡§π‡§ï ‡§ú‡•ã‡§°‡§º‡•á‡§Ç</button>
                </form>
            </div>
        </div></div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="script.js"></script>
</body>
</html>
